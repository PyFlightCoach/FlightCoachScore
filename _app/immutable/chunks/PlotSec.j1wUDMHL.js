import"./disclose-version.Bg9kRutz.js";import{A as re,u as _e,e as ie,m as L,n as oe,i as _,l as e,j as s,s as T,r as b,t as se,g as le,o as m,v as l,ac as be,f as ge,av as ye}from"./runtime.CwSbfP9F.js";import{e as x,s as we}from"./render.BfxXu2ce.js";import{i as R}from"./if.ZcvIpmxW.js";import{a as C,t as X,c as Ee}from"./template.Dj2c3_OM.js";import{s as ae}from"./style.B21HP8CR.js";import{i as ke}from"./lifecycle.Dpi4XHcX.js";import{p as g,u as Me}from"./props.DEpAHq7J.js";import{S as xe}from"./state.CheJn4lH.js";import{P as Ce}from"./Plot.C7q7TIXp.js";import{l as ne,r as Le}from"./layouts.BUGwDvF0.js";import{s as Z}from"./attributes.Dii1APe5.js";import{b as $}from"./preload-helper.CiPCvZEV.js";import{p as Pe,s as Se}from"./event-modifiers.Bfc47y5P.js";import{c as je}from"./colddraft.DYefmElu.js";function Re(W,d,y){re(()=>{var r=_e(()=>d(W,y==null?void 0:y())||{});if(r!=null&&r.destroy)return()=>r.destroy()})}var Te=X('<div class="double-range-container svelte-1507pyp"><div class="slider svelte-1507pyp"><div class="body svelte-1507pyp"></div> <div class="handle svelte-1507pyp" data-which="start"></div> <div class="handle svelte-1507pyp" data-which="end"></div></div></div>');function Xe(W,d){ie(d,!1);const y=m(),r=m();let f=g(d,"min",8,0),M=g(d,"max",8,1),H=g(d,"lhandle",28,f),N=g(d,"rhandle",28,M),z=m(),v=m(),Y=m();function E(i){let u,o;function S(c){c.type==="touchstart"&&(c=c.touches[0]),u=c.clientX,o=c.clientY,i.dispatchEvent(new CustomEvent("dragstart",{detail:{x:u,y:o}})),window.addEventListener("mousemove",h),window.addEventListener("mouseup",j),window.addEventListener("touchmove",h),window.addEventListener("touchend",j)}function h(c){c.type==="touchmove"&&(c=c.changedTouches[0]);const F=c.clientX-u,I=c.clientY-o;u=c.clientX,o=c.clientY,i.dispatchEvent(new CustomEvent("dragmove",{detail:{x:u,y:o,dx:F,dy:I}}))}function j(c){u=c.clientX,o=c.clientY,i.dispatchEvent(new CustomEvent("dragend",{detail:{x:u,y:o}})),window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",j),window.removeEventListener("touchmove",h),window.removeEventListener("touchend",j)}return i.addEventListener("mousedown",S),i.addEventListener("touchstart",S),{destroy(){i.removeEventListener("mousedown",S),i.removeEventListener("touchstart",S)}}}function w(i){return function(u){const{left:o,right:S}=e(Y).getBoundingClientRect(),h=S-o,j=Math.min(Math.max((u.detail.x-o)/h,0),1);s(r,Math.max(e(y),j)),N(Math.round(f()+(M()-f())*e(r)))}}L(()=>(l(H()),l(f()),l(M())),()=>{s(y,(H()-f())/(M()-f()))}),L(()=>(l(N()),l(f()),l(M())),()=>{s(r,(N()-f())/(M()-f()))}),oe();var q=Te(),A=_(q);$(A,i=>s(Y,i),()=>e(Y));var P=_(A);$(P,i=>s(v,i),()=>e(v));var n=T(P,2);$(n,i=>s(z,i),()=>e(z));var B=T(n,2),p=be(()=>w());b(A),b(q),se(()=>{Z(P,"style",`
				left: ${100*e(y)}%;
				right: ${100*(1-e(r))}%;
			`),Z(n,"style",`
				left: ${100*e(y)}%
			`),Z(B,"style",`
				left: ${100*e(r)}%
			`)}),Re(B,i=>E(i)),re(()=>x("dragmove",B,Pe(Se(function(...i){var u;(u=e(p))==null||u.apply(this,i)})))),C(W,q),le()}var Ye=X("<button>Pause</button>"),Ie=X("<button>Play</button>"),Ne=X("<button>+</button>"),qe=X("<button>-</button>"),De=X("<button>Slow</button>"),He=X("<button>Fast</button>"),ze=X("<button> </button>"),Ae=X('<div id="parent" class="svelte-1r2q1p0"><div><!></div> <div id="buttons" class="svelte-1r2q1p0"><div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div></div></div>');function nt(W,d){ie(d,!1);const y=m(),r=m(),f=m(),M=m(),H=m(),N=m(),z=m();let v=g(d,"flst",8),Y=g(d,"tpst",8,void 0),E=g(d,"i",12,void 0),w=g(d,"controls",24,()=>["slider","play","scale","speed","projection","modelClick","rangeEndClick","rangeStartClick"]),q=g(d,"scale",8,1),A=g(d,"scaleType",8,"range"),P=g(d,"speed",12,50),n=g(d,"range",28,()=>[0,v().data.length]),B=g(d,"fixRange",8,!1),p=m(1);const i=a=>{const t=a.slice(n()[0],n()[1]);return Math.max(t.range("x"),t.range("y"),t.range("z"))},u=(a,t,D,k)=>a?(k=k==-1?a.data.length:k,Le(new xe(a.data.slice(D,k)),t)):{type:"mesh3d",visible:!1};let o=m(structuredClone(ne));const S=(a,t,D)=>{if(a!=null&&t<a.data.length){const k=a.data[t];return je.scale(D*.3).to_mesh3d(k.pos,k.att,{opacity:1,hoverinfo:"skip",name:"fl model"})}else return{type:"mesh3d",visible:!1}};let h=m();const j=()=>{s(h,setInterval(()=>{E()!=null&&E()<v().data.length?Me(E):E(0)},P()))},c=()=>{clearInterval(e(h)),s(h,void 0)};L(()=>(l(v()),l(B())),()=>{v()&&B()&&n([0,v().data.length])}),L(()=>l(v()),()=>{s(y,i(v()))}),L(()=>(l(A()),e(y),l(q())),()=>{s(r,A()==="range"?e(y)*.01*q():q())}),L(()=>(l(v()),e(r),e(p),l(n())),()=>{s(f,u(v(),e(r)*e(p),...n()))}),L(()=>(l(Y()),e(r),e(p),l(n())),()=>{s(M,u(Y(),e(r)*e(p),...n()))}),L(()=>(l(v()),l(E()),e(r),e(p)),()=>{s(H,S(v(),E(),e(r)*e(p)))}),L(()=>(l(Y()),l(E()),e(r),e(p)),()=>{s(N,S(Y(),E(),e(r)*e(p)))}),L(()=>(e(f),e(M),e(H),e(N)),()=>{s(z,[e(f),e(M),e(H),e(N)])}),oe(),ke();var F=Ae();ae(F,"height","100%");var I=_(F);ae(I,"height","100%");var de=_(I);R(de,()=>e(z),a=>{Ce(a,{get data(){return e(z)},get layout(){return e(o)},fillParent:!0,$$events:{click:t=>{w().includes("modelClick")?E(n()[0]+Math.floor(t.detail.points[0].pointNumber/2)):w().includes("rangeEndClick")?n(n()[1]=n()[0]+Math.floor(t.detail.points[0].pointNumber/2),!0):w().includes("rangeStartClick")&&n(n()[0]=n()[0]+Math.floor(t.detail.points[0].pointNumber/2),!0)}}})}),b(I);var ee=T(I,2),J=_(ee),ce=_(J);R(ce,()=>w().includes("slider"),a=>{Xe(a,{min:0,get max(){return v().data.length},get lhandle(){return n()[0]},set lhandle(t){n(n()[0]=t,!0)},get rhandle(){return n()[1]},set rhandle(t){n(n()[1]=t,!0)},$$legacy:!0})}),b(J);var K=T(J,2),ve=_(K);R(ve,()=>w().includes("play"),a=>{var t=Ee(),D=ge(t);R(D,()=>e(h),k=>{var G=Ye();x("click",G,c),C(k,G)},k=>{var G=Ie();x("click",G,j),C(k,G)}),C(a,t)}),b(K);var O=T(K,2),ue=_(O);R(ue,()=>w().includes("scale"),a=>{var t=Ne();x("click",t,()=>{s(p,e(p)+.1)}),C(a,t)}),b(O);var Q=T(O,2),me=_(Q);R(me,()=>w().includes("scale"),a=>{var t=qe();x("click",t,()=>{s(p,Math.max(.2,e(p)-.2))}),C(a,t)}),b(Q);var U=T(Q,2),pe=_(U);R(pe,()=>w().includes("speed"),a=>{var t=De();x("click",t,()=>{P(Math.min(200,P()*1.6))}),C(a,t)}),b(U);var V=T(U,2),fe=_(V);R(fe,()=>w().includes("speed"),a=>{var t=He();x("click",t,()=>{P(Math.max(20,P()/1.6))}),C(a,t)}),b(V);var te=T(V,2),he=_(te);R(he,()=>w().includes("perspective"),a=>{var t=ze(),D=_(t);b(t),se(()=>we(D,e(o).scene.camera.projection.type)),x("click",t,()=>{s(o,structuredClone(ne)),ye(o,e(o).scene.camera.projection.type=e(o).scene.camera.projection.type=="perspective"?"orthographic":"perspective"),s(o,e(o))}),C(a,t)}),b(te),b(ee),b(F),x("mousedown",I,()=>{clearInterval(e(h))}),x("mouseup",I,()=>{e(h)&&j()}),C(W,F),le()}export{nt as P};
